# Kelly Criterion + Averaging + Dashboard - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. Kelly Criterion
‚úÖ –†–∞—Å—á—ë—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚úÖ –°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 —Å–¥–µ–ª–æ–∫
‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (ATR)
‚úÖ –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –¥—Ä–æ–±—å Kelly (25%)
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `get_position_size_percent()`

**–§–∞–π–ª—ã:**
- `config.py` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Kelly
- `paper_trader.py` - –º–µ—Ç–æ–¥ `calculate_kelly_fraction()`

### 2. –£–º–Ω–æ–µ –¥–æ–∫—É–ø–∞–Ω–∏–µ (Averaging)
‚úÖ AVERAGE_DOWN - —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Ü–µ–Ω—ã
‚úÖ PYRAMID_UP - –ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ (ADX > 25)
‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–æ–∫—É–ø–∞–Ω–∏–π (MAX_AVERAGING_ATTEMPTS)
‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±—â–µ–≥–æ —Ä–∏—Å–∫–∞ (MAX_TOTAL_RISK_MULTIPLIER)
‚úÖ –£–º–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SL/TP (–Ω–µ —Å—É–∂–∞–µ–º SL)
‚úÖ –ò—Å—Ç–æ—Ä–∏—è –¥–æ–∫—É–ø–∞–Ω–∏–π

**–§–∞–π–ª—ã:**
- `config.py` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Averaging
- `paper_trader.py` - –º–µ—Ç–æ–¥—ã `can_average_down()`, `average_position()`

### 3. Streamlit Dashboard
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û–±–∑–æ—Ä" - KPI –∏ equity curve
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏" - —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–æ–∫—É–ø–∞–Ω–∏—è–º–∏
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫" - —Ñ–∏–ª—å—Ç—Ä—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ú–µ—Ç—Ä–∏–∫–∏" - Sharpe, Sortino, Drawdown, Kelly
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ë—ç–∫—Ç–µ—Å—Ç—ã" - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (60 —Å–µ–∫)
‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–§–∞–π–ª—ã:**
- `dashboard.py` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª dashboard
- `DASHBOARD_README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 4. Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/kelly_info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Kelly Criterion
‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/averaging_status` - —Å—Ç–∞—Ç—É—Å –¥–æ–∫—É–ø–∞–Ω–∏–π –ø–æ –ø–æ–∑–∏—Ü–∏—è–º

**–§–∞–π–ª—ã:**
- `telegram_bot.py` - –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

### 5. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚úÖ `requirements.txt` –æ–±–Ω–æ–≤–ª–µ–Ω:
- streamlit>=1.32.0
- plotly>=5.18.0
- scipy>=1.11.0

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ config.py
–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `config.py`:

```python
# Kelly Criterion (–≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
USE_KELLY_CRITERION = True
KELLY_FRACTION = 0.25
MIN_TRADES_FOR_KELLY = 10
KELLY_LOOKBACK_WINDOW = 50

# Averaging (–≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
ENABLE_AVERAGING = True
MAX_AVERAGING_ATTEMPTS = 2
AVERAGING_PRICE_DROP_PERCENT = 0.05
AVERAGING_TIME_THRESHOLD_HOURS = 24
MAX_TOTAL_RISK_MULTIPLIER = 1.5

# Pyramid Mode (–≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
ENABLE_PYRAMID_UP = True
PYRAMID_ADX_THRESHOLD = 25
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
python bot.py
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ Dashboard
–í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
streamlit run dashboard.py
```

Dashboard –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8501

### –®–∞–≥ 5: Telegram –∫–æ–º–∞–Ω–¥—ã
```
/paper_start - –ó–∞–ø—É—Å—Ç–∏—Ç—å paper trading
/kelly_info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Kelly Criterion
/averaging_status - –°—Ç–∞—Ç—É—Å –¥–æ–∫—É–ø–∞–Ω–∏–π
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: Kelly Criterion (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ)

1. –û—Ç–∫–ª—é—á–∏—Ç–µ averaging –≤ `config.py`:
```python
ENABLE_AVERAGING = False
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫—Ç–µ—Å—Ç:
```bash
python backtest.py BTCUSDT 1h 2024-01-01 2024-06-01
```

3. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - ROI –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ
   - Max Drawdown –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ
   - Win Rate –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –ø—Ä–µ–∂–Ω–∏–º, –Ω–æ —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ Dashboard:
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ú–µ—Ç—Ä–∏–∫–∏" ‚Üí Kelly —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
   - Equity curve –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª–µ–µ –≥–ª–∞–¥–∫–æ–π

### –¢–µ—Å—Ç 2: Averaging (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ)

1. –û—Ç–∫–ª—é—á–∏—Ç–µ Kelly –≤ `config.py`:
```python
USE_KELLY_CRITERION = False
ENABLE_AVERAGING = True
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ paper trading:
```bash
python bot.py
# –í Telegram: /paper_start
```

3. –ñ–¥–∏—Ç–µ –¥–æ–∫—É–ø–∞–Ω–∏—è (24 —á–∞—Å–∞ + –ø–∞–¥–µ–Ω–∏–µ 5%)

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - `/averaging_status` - —Å—Ç–∞—Ç—É—Å –¥–æ–∫—É–ø–∞–Ω–∏–π
   - Dashboard ‚Üí "–¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏" - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–ø–∞–Ω–∏–π
   - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç—å—Å—è

### –¢–µ—Å—Ç 3: –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

1. –í–∫–ª—é—á–∏—Ç–µ –æ–±–∞ –º–æ–¥—É–ª—è:
```python
USE_KELLY_CRITERION = True
ENABLE_AVERAGING = True
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ walkforward –∞–Ω–∞–ª–∏–∑:
```bash
python backtest_walkforward.py BTCUSDT 1h 2024-01-01 2024-06-01
```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - ROI –¥–æ–ª–∂–µ–Ω —É–ª—É—á—à–∏—Ç—å—Å—è
   - Sharpe Ratio –¥–æ–ª–∂–µ–Ω –≤—ã—Ä–∞—Å—Ç–∏
   - Max Drawdown –¥–æ–ª–∂–µ–Ω —Å–Ω–∏–∑–∏—Ç—å—Å—è

4. Dashboard:
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ë—ç–∫—Ç–µ—Å—Ç—ã" ‚Üí —Å—Ä–∞–≤–Ω–∏—Ç–µ —Å baseline
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏

### –¢–µ—Å—Ç 4: Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ Dashboard:
```bash
streamlit run dashboard.py
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
   - ‚úÖ –û–±–∑–æ—Ä - KPI –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
   - ‚úÖ –¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏ - —Ç–∞–±–ª–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   - ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫ - —Ñ–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   - ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ - –≥—Ä–∞—Ñ–∏–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
   - ‚úÖ –ë—ç–∫—Ç–µ—Å—Ç—ã - —Ñ–∞–π–ª—ã –∏–∑ `backtests/` –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

3. –¢–µ—Å—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
   - –í–∫–ª—é—á–∏—Ç–µ "–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (60—Å)"
   - –°–æ–≤–µ—Ä—à–∏—Ç–µ —Å–¥–µ–ª–∫—É –≤ –±–æ—Ç–µ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å

4. –¢–µ—Å—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫" ‚Üí –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –î–æ –∏ –ü–æ—Å–ª–µ

**Baseline (–±–µ–∑ Kelly –∏ Averaging):**
```bash
python backtest.py BTCUSDT 1h 2024-01-01 2024-06-01
```
–ó–∞–ø–∏—à–∏—Ç–µ: ROI, Sharpe, Max DD, Win Rate

**–° Kelly (–±–µ–∑ Averaging):**
```python
USE_KELLY_CRITERION = True
ENABLE_AVERAGING = False
```
```bash
python backtest.py BTCUSDT 1h 2024-01-01 2024-06-01
```
–û–∂–∏–¥–∞–µ–º–æ: ROI ~same, Sharpe +10-15%, Max DD -10-20%

**–° Averaging (–±–µ–∑ Kelly):**
```python
USE_KELLY_CRITERION = False
ENABLE_AVERAGING = True
```
```bash
python backtest.py BTCUSDT 1h 2024-01-01 2024-06-01
```
–û–∂–∏–¥–∞–µ–º–æ: ROI +5-10%, Win Rate +5-10%, Max DD –º–æ–∂–µ—Ç –≤—ã—Ä–∞—Å—Ç–∏

**–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
```python
USE_KELLY_CRITERION = True
ENABLE_AVERAGING = True
```
```bash
python backtest.py BTCUSDT 1h 2024-01-01 2024-06-01
```
–û–∂–∏–¥–∞–µ–º–æ: ROI +10-20%, Sharpe +15-25%, Max DD -15-25%

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

‚úÖ **Kelly —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ –µ—Å–ª–∏:**
- Sharpe Ratio –≤—ã—Ä–æ—Å –Ω–∞ >10%
- Max Drawdown —Å–Ω–∏–∑–∏–ª—Å—è –Ω–∞ >10%
- –†–∞–∑–º–µ—Ä—ã –ø–æ–∑–∏—Ü–∏–π –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ `paper_trading_state.json`)

‚úÖ **Averaging —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ –µ—Å–ª–∏:**
- Win Rate –≤—ã—Ä–æ—Å –Ω–∞ >5%
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –¥–æ–∫—É–ø–∞–Ω–∏–π > 50%
- –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –¥–æ–∫—É–ø–∞–Ω–∏—è –ª—É—á—à–µ –∏—Å—Ö–æ–¥–Ω–æ–π

‚úÖ **Dashboard —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—Å–ª–∏:**
- –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –ì—Ä–∞—Ñ–∏–∫–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ
- –î–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Kelly –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
python -c "from paper_trader import PaperTrader; pt = PaperTrader(); pt.load_state(); print(pt.calculate_kelly_fraction('BTCUSDT', 1.5))"
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–¥–µ–ª–æ–∫ (<10)
2. USE_KELLY_CRITERION = False
3. –û—à–∏–±–∫–∞ –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏)

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ–ª—å—à–µ —Å–¥–µ–ª–æ–∫
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ config.py
- –í–∫–ª—é—á–∏—Ç–µ DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞: Averaging –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –í Telegram
/averaging_status
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ENABLE_AVERAGING = False
2. –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ª–æ–≤–∏—è (–≤—Ä–µ–º—è + —Ü–µ–Ω–∞)
3. –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –¥–æ–∫—É–ø–∞–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.py
- –£–º–µ–Ω—å—à–∏—Ç–µ AVERAGING_TIME_THRESHOLD_HOURS –¥–ª—è —Ç–µ—Å—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `grep "AVERAGE" logs/tradebot.log`

### –ü—Ä–æ–±–ª–µ–º–∞: Dashboard –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞
ls -lh paper_trading_state.json

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
python -c "import json; print(json.load(open('paper_trading_state.json'))['balance'])"
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ paper trading: `/paper_start`
2. –°–æ–≤–µ—Ä—à–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Å–¥–µ–ª–∫—É
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à Streamlit: `streamlit cache clear`
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Dashboard

### –ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –ø—Ä–∏ Averaging

**–°–∏–º–ø—Ç–æ–º—ã:**
- Max Drawdown —É–≤–µ–ª–∏—á–∏–ª—Å—è >20%
- –ú–Ω–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É–±—ã—Ç–æ—á–Ω—ã—Ö –¥–æ–∫—É–ø–∞–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ MAX_AVERAGING_ATTEMPTS (—Å 2 –¥–æ 1)
2. –£–≤–µ–ª–∏—á—å—Ç–µ AVERAGING_PRICE_DROP_PERCENT (—Å 5% –¥–æ 7%)
3. –£–≤–µ–ª–∏—á—å—Ç–µ AVERAGING_TIME_THRESHOLD_HOURS (—Å 24 –¥–æ 48)
4. –û—Ç–∫–ª—é—á–∏—Ç–µ ENABLE_PYRAMID_UP –Ω–∞ —Ñ–ª—ç—Ç–æ–≤—ã—Ö —Ä—ã–Ω–∫–∞—Ö

## üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### Kelly Fraction
```python
# –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
KELLY_FRACTION = 0.25  # 25% –æ—Ç –ø–æ–ª–Ω–æ–≥–æ Kelly

# –£–º–µ—Ä–µ–Ω–Ω—ã–π
KELLY_FRACTION = 0.40  # 40%

# –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
KELLY_FRACTION = 0.50  # 50%
```

### Averaging –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```python
# –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π (–¥–ª—è —Ñ–ª—ç—Ç–∞)
MAX_AVERAGING_ATTEMPTS = 1
AVERAGING_PRICE_DROP_PERCENT = 0.07  # 7%
AVERAGING_TIME_THRESHOLD_HOURS = 48

# –£–º–µ—Ä–µ–Ω–Ω—ã–π (–±–∞–∑–æ–≤—ã–π)
MAX_AVERAGING_ATTEMPTS = 2
AVERAGING_PRICE_DROP_PERCENT = 0.05  # 5%
AVERAGING_TIME_THRESHOLD_HOURS = 24

# –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π (–¥–ª—è —Ç—Ä–µ–Ω–¥–∞)
MAX_AVERAGING_ATTEMPTS = 3
AVERAGING_PRICE_DROP_PERCENT = 0.03  # 3%
AVERAGING_TIME_THRESHOLD_HOURS = 12
```

### Pyramid –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```python
# –¢–æ–ª—å–∫–æ —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥
PYRAMID_ADX_THRESHOLD = 30

# –ë–∞–∑–æ–≤—ã–π
PYRAMID_ADX_THRESHOLD = 25

# –£–º–µ—Ä–µ–Ω–Ω—ã–π —Ç—Ä–µ–Ω–¥ (—Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–µ–µ)
PYRAMID_ADX_THRESHOLD = 20
```

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Kelly Criterion**: https://en.wikipedia.org/wiki/Kelly_criterion
- **Position Sizing**: https://www.investopedia.com/terms/k/kellycriterion.asp
- **Averaging Strategies**: https://www.investopedia.com/terms/a/averagedown.asp
- **Pyramiding**: https://www.investopedia.com/terms/p/pyramiding.asp
- **Sharpe Ratio**: https://www.investopedia.com/terms/s/sharperatio.asp

## ‚úÖ Checklist –¥–ª—è –¥–µ–ø–ª–æ—è

- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ Kelly –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ Averaging –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª–∏ walkforward –∞–Ω–∞–ª–∏–∑ (6+ –º–µ—Å—è—Ü–µ–≤)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ Dashboard –Ω–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ Telegram –∫–æ–º–∞–Ω–¥—ã `/kelly_info` –∏ `/averaging_status`
- [ ] –ù–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ —Å–≤–æ–π —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å
- [ ] –ë—ç–∫–∞–ø `paper_trading_state.json`
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ (`tail -f logs/tradebot.log`)
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Kelly Criterion** - —ç—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è, –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—è. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—É—é –¥—Ä–æ–±—å.
2. **Averaging** –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ—Å–∞–¥–∫—É. –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π—Ç–µ MAX_TOTAL_RISK_MULTIPLIER.
3. **Pyramid Mode** —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö —Ä—ã–Ω–∫–∞—Ö (ADX > 25).
4. **Dashboard** - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞, –Ω–µ —Ç–æ—Ä–≥–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞.
5. –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ paper trading –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–µ–Ω—å–≥–∞–º–∏.

–£–¥–∞—á–∏! üöÄ

